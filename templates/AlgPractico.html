<!-- templates/AlgPractico.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Ejercicio Pr√°ctico - Algoritmo de Clasificaci√≥n</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- CSS externo -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="alg-practico-page">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">üè† Men√∫ Principal</a>
            <div class="navbar-nav">
                <a class="nav-link" href="/AlgConceptos">Conceptos</a>
                <a class="nav-link active" href="/AlgPractico">Ejercicio Pr√°ctico</a>
            </div>
        </div>
    </nav>

    <div class="container section">
        <h2 class="mb-3 text-center">Ejercicio Pr√°ctico ‚Äî Algoritmo de Clasificaci√≥n</h2>
        <p class="lead text-center">
            Predicci√≥n de <b>fracaso en emprendimientos</b> usando variables de capital, experiencia, socios y a√±os en operaci√≥n.
        </p>

        <!-- Dataset -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">Descripci√≥n del dataset</div>
            <div class="card-body">
                <ul>
                    <li><strong>CapitalInicial</strong> (num√©rica)</li>
                    <li><strong>Experiencia</strong> (categ√≥rica: 0=Baja, 1=Media, 2=Alta)</li>
                    <li><strong>NumSocios</strong> (num√©rica)</li>
                    <li><strong>AniosOperacion</strong> (num√©rica)</li>
                </ul>
                <p>
                    Objetivo: <strong>Fracaso</strong> (1 = ‚ÄúS√≠‚Äù, 0 = ‚ÄúNo‚Äù).  
                    Clase positiva: <strong>1 (‚ÄúS√≠‚Äù)</strong>.
                </p>
            </div>
        </div>

                <!-- M√©tricas + Reporte de Clasificaci√≥n en 2 columnas -->
        <div class="row mb-4">
            <div class="col-md-5 offset-md-1">
                <div class="card metric-card shadow-sm">
                    <div class="card-body text-center">
                        Exactitud: <span class="text-success">{{ accuracy_pct }}%</span>
                    </div>
                </div>
            </div>
            <div class="col-md-5">
                <div class="card mb-4">
                    <div class="card-header bg-info text-white text-center">
                        Reporte de Clasificaci√≥n
                    </div>
                    <div class="card-body text-center">
                        {{ report_html|safe }}
                    </div>
                </div>
            </div>
        </div>

        <!-- Matriz de Confusi√≥n centrada -->
        <div class="row mb-4">
            <div class="col-md-8 offset-md-2">
                <div class="card mb-4">
                    <div class="card-header bg-secondary text-white text-center">
                        Matriz de Confusi√≥n
                    </div>
                    <div class="card-body text-center">
                        <img src="{{ cm_img_path }}" class="confusion-img" alt="Matriz de confusi√≥n">
                    </div>
                </div>
            </div>
        </div>


        <!-- Formulario -->
        <div class="card form-section">
            <div class="card-header bg-success text-white">Formulario de Predicci√≥n</div>
            <div class="card-body">
                <form method="post" action="/AlgPractico" class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label">Capital Inicial</label>
                        <input type="number" step="0.01" name="CapitalInicial" class="form-control" placeholder="Ej: 10000" required>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">Experiencia</label>
                        <select name="Experiencia" class="form-select" required>
                            <option value="">Seleccione‚Ä¶</option>
                            <option value="0">Baja</option>
                            <option value="1">Media</option>
                            <option value="2">Alta</option>
                        </select>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">N√∫mero de Socios</label>
                        <input type="number" name="NumSocios" class="form-control" required>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">A√±os de Operaci√≥n</label>
                        <input type="number" name="AniosOperacion" class="form-control" required>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">Threshold (0-1)</label>
                        <input type="number" step="0.01" min="0" max="1" name="threshold" value="{{ threshold or 0.5 }}" class="form-control">
                    </div>

                    <div class="col-12 text-center">
                        <button type="submit" class="btn btn-primary">Predecir</button>
                    </div>
                </form>

                {% if pred_label %}
                <div class="alert alert-info mt-3">
                    <h5>Predicci√≥n: <b>{{ pred_label }}</b></h5>
                    <p>Probabilidad (clase ‚ÄúS√≠‚Äù): <b>{{ "%.4f"|format(pred_prob) }}</b></p>
                    <small>
                        Con threshold={{ threshold }} se interpreta el resultado seg√∫n la sensibilidad del modelo.
                    </small>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Informe -->
        <div class="mt-4 text-muted small text-center">
            {{ informe }}
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
